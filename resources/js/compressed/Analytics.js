var Analytics={GoogleVisualizationCalled:!1,GoogleVisualizationReady:!1,reports:{}};Analytics.ChartOptions=Garnish.Base.extend({},{area:function(t){switch(options=this.defaults.area,t){case"week":options.hAxis.format="E",options.hAxis.showTextEvery=1;break;case"month":options.hAxis.format="MMM d",options.hAxis.showTextEvery=1;break;case"year":options.hAxis.showTextEvery=1,options.hAxis.format="MMM yy"}return options},table:function(){return this.defaults.table},geo:function(t){switch(options=this.defaults.geo,t){case"ga:city":options.displayMode="markers";break;case"ga:country":options.resolution="countries",options.displayMode="regions";break;case"ga:continent":options.resolution="continents",options.displayMode="regions";break;case"ga:subContinent":options.resolution="subcontinents",options.displayMode="regions"}return options},pie:function(){return this.defaults.pie},field:function(){return{theme:"maximized",legend:"none",backgroundColor:"#fdfdfd",colors:["#058DC7"],areaOpacity:.1,pointSize:0,lineWidth:4,height:120,hAxis:{format:"MMM d",textPosition:"in",textStyle:{color:"#058DC7"},showTextEvery:1,baselineColor:"#fff",gridlines:{color:"none"}},vAxis:{textPosition:"in",textStyle:{color:"#058DC7"},baselineColor:"#ccc",gridlines:{color:"#f4f4f4"},minValue:0,maxValue:10,format:"#"}}},defaults:{area:{theme:"maximized",legend:"none",backgroundColor:"#FFF",colors:["#058DC7"],areaOpacity:.1,pointSize:7,lineWidth:4,chartArea:{},hAxis:{format:"E",textPosition:"in",textStyle:{color:"#058DC7"},showTextEvery:1,baselineColor:"#fff",gridlines:{color:"none"}},vAxis:{textPosition:"in",textStyle:{color:"#058DC7"},baselineColor:"#ccc",gridlines:{color:"#fafafa"},minValue:0,maxValue:10,format:"#"}},geo:{displayMode:"auto"},pie:{theme:"maximized",height:282,pieHole:.5,legend:{alignment:"center",position:"top"},chartArea:{top:40,height:"82%"},sliceVisibilityThreshold:1/120},table:{}}}),Analytics.Metadata={getContinentByCode:function(t){var e;return $.each(Analytics.continents,function(n,a){t==a.code&&(e=a.label)}),e?e:t},getSubContinentByCode:function(t){var e;return $.each(Analytics.subContinents,function(n,a){t==a.code&&(e=a.label)}),e?e:t}},Analytics.Utils={responseToDataTable:function(t){var e=new google.visualization.DataTable;return $.each(t.cols,function(t,n){var a;switch(n.type){case"percent":case"time":case"integer":case"currency":case"float":a="number";break;case"continent":case"subContinent":a="string";break;default:a=n.type}e.addColumn({type:a,label:n.label+"("+n.type+")",id:n.id})}),$.each(t.rows,function(n,a){$.each(a,function(e,n){switch(t.cols[e].type){case"continent":case"subContinent":case"currency":case"percent":case"time":a[e]={v:n,f:Analytics.Utils.formatByType(t.cols[e].type,n)};break;default:a[e]=Analytics.Utils.formatByType(t.cols[e].type,n)}}),e.addRow(a)}),e},formatByType:function(type,value){switch(type){case"continent":return Analytics.Metadata.getContinentByCode(value);case"subContinent":return Analytics.Metadata.getSubContinentByCode(value);case"currency":return Analytics.Utils.formatCurrency(value);case"time":return Analytics.Utils.formatDuration(value);case"percent":return Analytics.Utils.formatPercent(value);case"date":if($dateString=value,8==$dateString.length)return $year=eval($dateString.substr(0,4)),$month=eval($dateString.substr(4,2))-1,$day=eval($dateString.substr(6,2)),$date=new Date($year,$month,$day),$date;if(6==$dateString.length)return $year=eval($dateString.substr(0,4)),$month=eval($dateString.substr(4,2))-1,$date=new Date($year,$month,"01"),$date;break;default:return value}},formatPercent:function(t){return this.getD3Locale().numberFormat(Analytics.formats.percentFormat)(t/100)},formatCurrency:function(t){return this.getD3Locale().numberFormat(Analytics.formats.currencyFormat)(t)},getD3Locale:function(){var t=window.d3_locale;return d3.locale(t)},formatDuration:function(t){var e=parseInt(t,10),n=Math.floor(e/3600),a=Math.floor((e-3600*n)/60),i=e-3600*n-60*a;return n<10&&(n="0"+n),a<10&&(a="0"+a),i<10&&(i="0"+i),n+":"+a+":"+i}},Analytics.Visualization=Garnish.Base.extend({options:null,afterInitStack:[],init:function(t){this.options=t,0==Analytics.GoogleVisualizationCalled?(Analytics.GoogleVisualizationCalled=!0,"undefined"==typeof AnalyticsChartLanguage&&(AnalyticsChartLanguage="en"),google.load("visualization","1",{packages:["corechart","table"],language:AnalyticsChartLanguage,callback:$.proxy(function(){Analytics.GoogleVisualizationReady=!0,this.onAfterInit(),this.onAfterFirstInit()},this)})):this.onAfterInit()},onAfterFirstInit:function(){for(i=0;i<this.afterInitStack.length;i++)this.afterInitStack[i]()},onAfterInit:function(){Analytics.GoogleVisualizationReady?this.options.onAfterInit():this.afterInitStack.push(this.options.onAfterInit)}});