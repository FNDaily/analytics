function analyticsRealtimeRequest(){$(".analytics-widget-realtime").parent().parent().addClass("loading");var e={};Craft.postActionRequest("analytics/realtime",e,function(e){$(".analytics-widget-realtime .analytics-errors-inject").html("");if(typeof e.error!="undefined"){$(".analytics-widget-realtime .analytics-errors").removeClass("hidden");$(".analytics-widget-realtime .analytics-widget").addClass("hidden");$('<p class="error">'+e.error.message+"</p>").appendTo(".analytics-widget-realtime .analytics-errors-inject")}else{$(".analytics-widget-realtime .analytics-errors").addClass("hidden");$(".analytics-widget-realtime .analytics-widget").removeClass("hidden");var t=e.visitorType.newVisitor,n=e.visitorType.returningVisitor,r=n*1+t*1;$(".analytics-widget-realtime .active-visitors .count").text(r);if(r>0){$(".analytics-widget-realtime .progress").removeClass("hidden");$(".analytics-widget-realtime .legend").removeClass("hidden")}else{$(".analytics-widget-realtime .progress").addClass("hidden");$(".analytics-widget-realtime .legend").addClass("hidden")}if(r>0)var i=Math.round(100*t/r);else var i=100;var s=100-i;$(".analytics-widget-realtime .progress-bar.blue").css("width",i+"%");$(".analytics-widget-realtime .progress-bar.blue span").text(i+"%");i>0?$(".analytics-widget-realtime .progress-bar.blue").removeClass("hidden"):$(".analytics-widget-realtime .progress-bar.blue").addClass("hidden");$(".analytics-widget-realtime .progress-bar.green").css("width",s+"%");$(".analytics-widget-realtime .progress-bar.green span").text(s+"%");s>0?$(".analytics-widget-realtime .progress-bar.green").removeClass("hidden"):$(".analytics-widget-realtime .progress-bar.green").addClass("hidden");if(r>0){$(".no-active-visitors").addClass("hidden");$(".analytics-realtime-content table").removeClass("hidden");$(".analytics-realtime-content tbody").html("");$.each(e.content,function(e,t){var n=$("<tr><td>"+e+'</td><td class="thin">'+t+"</td></td>");$(".analytics-realtime-content tbody").append(n)});$(".analytics-realtime-sources table").removeClass("hidden");$(".analytics-realtime-sources tbody").html("");$.each(e.sources,function(e,t){var n=$("<tr><td>"+e+'</td><td class="thin">'+t+"</td></td>");$(".analytics-realtime-sources tbody").append(n)});$(".analytics-realtime-countries table").removeClass("hidden");$(".analytics-realtime-countries tbody").html("");$.each(e.countries,function(e,t){var n=$("<tr><td>"+e+'</td><td class="thin">'+t+"</td></td>");$(".analytics-realtime-countries tbody").append(n)})}else{$(".no-active-visitors").removeClass("hidden");$(".analytics-realtime-content table").addClass("hidden");$(".analytics-realtime-sources table").addClass("hidden");$(".analytics-realtime-countries table").addClass("hidden")}}$(".analytics-widget-realtime").parent().parent().removeClass("loading")})}$(document).ready(function(){var refreshInterval=eval(Analytics.realtimeRefreshInterval);analyticsRealtimeRequest();refreshInterval==null?refreshInterval=10:refreshInterval<2&&(refreshInterval=100);refreshInterval*=1e3;setInterval(analyticsRealtimeRequest,refreshInterval)});