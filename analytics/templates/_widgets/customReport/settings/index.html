{% import "_includes/forms" as forms %}
{% includeJsResource 'analytics/js/customReportSettings.js' %}

{{ forms.textField({
    first: true,
    label: "Name"|t,
    name: 'name',
    placeholder: 'My Widget',
    value: settings.name
}) }}


{% set colspanOptions = { 1:1, 2:2, 3:3, 4:4 } %}

{{ forms.selectField({
    first: true,
    label: "Columns"|t,
    options: colspanOptions,
    name: 'colspan',
    value: (settings.colspan is not null ? settings.colspan : 2)
}) }}


<hr>
{#
{{ forms.selectField({
    label: "Report Type"|t,
    options: {standard:"Standard", realtime:"Real-Time"},
    name: 'options[reportType]',
    value: (settings.options.reportType is defined ? settings.options.reportType : '')
}) }} #}

<input type="hidden" name="options[reportType]" value="standard" />


{% set chartType = (settings.options.chartType is defined ? settings.options.chartType : 'AreaChart') %}

{{ forms.selectField({
    label: "Chart Type"|t,
    options: {
        "AreaChart":"Area Chart",
        "ColumnChart":"Column Chart",
        "GeoChart":"Geo Chart",
        "PieChart":"Pie Chart",
        "Table":"Table",
    },
    name: 'options[chartType]',
    value: chartType,
    toggle: true,
    targetPrefix: 'type-',
}) }}



{{ forms.selectField({
    label: "Metric"|t,
    options: craft.analytics.metricOpts,
    name: 'options[metric]',
    value: (settings.options.metric is defined ? settings.options.metric : '')
}) }}

{% include 'analytics/_widgets/customReport/settings/area' %}
{% include 'analytics/_widgets/customReport/settings/bar' %}
{% include 'analytics/_widgets/customReport/settings/column' %}
{% include 'analytics/_widgets/customReport/settings/geo' %}
{% include 'analytics/_widgets/customReport/settings/pie' %}
{% include 'analytics/_widgets/customReport/settings/table' %}

<hr>



{% set dataFilters = (settings.options.filters is defined ? settings.options.filters : false) %}

<table class="data analytics-filters">
    <tbody>
        {% for dataFilter in dataFilters %}
            {% set k = loop.index0 %}
            <tr>
                <td>
                    {{ forms.selectField({
                        options: {
                            show:"Show",
                            hide:"Don't Show"
                        },
                        name: 'options[filters]['~k~'][visibility]',
                        value: (dataFilter.visibility is defined ? dataFilter.visibility : '')
                    }) }}
                </td>
                <td>

                    {{ forms.selectField({
                        options: craft.analytics.dimensionOpts,
                        name: 'options[filters]['~k~'][dimension]',
                        value: (dataFilter.dimension is defined ? dataFilter.dimension : '')
                    }) }}
                </td>
                <td>
                    {{ forms.selectField({
                        options: {
                            exactMatch:"Exact Match",
                            regularExpression:"Regular Expression",
                            contains:"Contains",
                        },
                        name: 'options[filters]['~k~'][operator]',
                        value: (dataFilter.operator is defined ? dataFilter.operator : 'contains')
                    }) }}
                </td>
                <td>
                    {{ forms.textField({
                        name: 'options[filters]['~k~'][value]',
                        value: (dataFilter.value is defined ? dataFilter.value : '')
                    }) }}
                </td>
                <td>
                    <span class="btn small analytics-remove-filter">Remove</span>
                </td>
            </tr>
        {% endfor %}
        <tr class="prototype hidden">
            <td>
                {{ forms.selectField({
                    options: {
                        show:"Show",
                        hide:"Don't Show"
                    },
                    name: 'options[filters][{index}][visibility]'
                }) }}
            </td>
            <td>

                {{ forms.selectField({
                    options: craft.analytics.dimensionOpts,
                    name: 'options[filters][{index}][dimension]'
                }) }}
            </td>
            <td>
                {{ forms.selectField({
                    options: {
                        exactMatch:"Exact Match",
                        regularExpression:"Regular Expression",
                        contains:"Contains",
                    },
                    name: 'options[filters][{index}][operator]',
                    value: 'contains'
                }) }}
            </td>
            <td>
                {{ forms.textField({
                    name: 'options[filters][{index}][value]'
                }) }}
            </td>
            <td>
                <span class="btn small analytics-remove-filter">Remove</span>
            </td>
        </tr>
    </tbody>
</table>

<p>
    <span class="btn small analytics-add-filter">Add Filter</span>
</p>

<hr>